<div
  class="portfolio__section
  {% if page.slug == 'lvcloud' %} portfolio__section--half-orange
  {% else %} portfolio__section--orange {% endif %}"
>
  <span class="portfolio__step">{{ page.solution-title }}</span>
  <h2 class="portfolio__title">{{ page.solution-subtitle }}</h2>

  {% if page.solution-description %}
    <p class="portfolio__description">{{ page.solution-description }}</p>
  {% endif %}

  {% if page.solution-image %}
    <div class="portfolio__columns portfolio-answer">
      <div class="portfolio__columns--left">
        <p class="paragraph">{{ page.solution-column-1 }}</p>
      </div>
      <div class="portfolio__columns--right">
        <img src="{{ page.solution-image }}" alt="page.solution-alt" />
      </div>
    </div>
  {% endif %}

  {% if page.slug == "lvcloud" %}
    <div class="portfolio-solutions">

      {% for solution in page.solutions %}
        <div {{ solution.solution.animation }} class="portfolio__columns {{ solution.solution.class }}">
          <div class="portfolio-solutions__description">

            {% if solution.solution.title %}
              <h3 class="portfolio-solutions__header">{{ solution.solution.title }}</h3>
            {% endif %}

            <p class="paragraph">{{ solution.solution.text }}</p>

            {% if solution.solution.dots == true %}
              <span class="portfolio__dot portfolio__dot--secondary"></span>
              <span class="portfolio__dot portfolio__dot--yellow"></span>
              <span class="portfolio__dot portfolio__dot--blue"></span>
            {% endif%}

          </div>
          <div class="portfolio-solutions__image">
            <img src="{{ solution.solution.image }}" alt="{{ solution.solution.alt }}"/>
            <figure class="geometric-figure {{ solution.solution.geometric-class }}">
              <div class="geometric-figure_center"></div>
              <div class="geometric-figure_right"></div>
            </figure>
          </div>
        </div>
      {% endfor %}

    </div>

    <div class="portfolio-tabs">
      <div class="portfolio-tabs__menu">
        <ul class="portfolio-tabs__menu-list">
          {% for tab in page.tabs %}
            <li
              data-index="{{ tab.tab.index }}"
              data-tab="tab-{{ tab.tab.index }}"
              data-active="{% if tab.tab.index == 1 %}true{% else %}false{% endif %}"
              class="tabs-item portfolio-tabs__menu-list__item"
            >
              {{ tab.tab.title }}
              <span></span>
            </li>
          {% endfor %}
        </ul>
      </div>

      <div class="portfolio-tabs__content">
        {% for tab in page.tabs %}
          <div
            id="tab-{{ tab.tab.index }}"
            data-active="{% if tab.tab.index == 1 %}true{% else %}false{% endif %}"
            class="tabs-tab portfolio-tabs__content-tab portfolio-tabs__content-tab--tab{{ tab.tab.index }}"
          >
            <img src="{{ tab.tab.image }}"/>
          </div>
        {% endfor %}
      </div>
    </div>

  {% endif %}

  <div class="portfolio-features">

    {% for feature in page.features %}
      <div {{ feature.feature.animation }} class="portfolio__columns {{ feature.feature.class }}">
        <div class="portfolio-features__description">
          <h3 class="portfolio-features__header">{{ feature.feature.title }}</h3>
          <ul class="portfolio__list {% if page.slug == 'lvcloud' %}portfolio__list--lvcloud{% endif %}">
            {{ feature.feature.list }}
          </ul>
        </div>
        <div class="portfolio-features__image">
          <img src="{{ feature.feature.image }}" />
        </div>
      </div>
    {% endfor %}

  </div>

  <div class="portfolio-stack">
    <h3 class="portfolio-stack__header"> {{ page.stack-title }} </h3>
    <ul class="portfolio__columns">

      {% for technology in page.stack %}
        <li>
          <div class="portfolio-stack__image {{ technology.technology.image-class }}">
            <img src="{{ technology.technology.image }}" alt="{{ technology.technology.alt }}"/>
          </div>
          <h4 class="portfolio-stack__subheader">{{ technology.technology.name }}</h4>
          <p class="paragraph">{{ technology.technology.description }}</p>
        </li>
      {% endfor %}

    </ul>
  </div>

  {% if page.tools %}
    <div class="portfolio-stack portfolio-stack--tools">
      <h3 class="portfolio-stack__header"> {{ page.tools-title }} </h3>
      <ul class="portfolio__columns">

        {% for tool in page.tools %}
          <li>
            <div class="portfolio-stack__image {{ tool.tool.image-class }}">
              <img src="{{ tool.tool.image }}" alt="{{ tool.tool.alt }}"/>
            </div>
            <h4 class="portfolio-stack__subheader">{{ tool.tool.name }}</h4>
          </li>
        {% endfor %}

      </ul>
    </div>
  {% endif %}

  <div class="portfolio-experts">
    <h3 class="portfolio-experts__header"> {{ page.experts-title }} </h3>
    <ul class="portfolio__columns">

      {% for expert in page.experts %}
        <li>
          <div class="portfolio-experts__number">
            <span>{{ expert.expert.number }}</span>
          </div>
          <span class="icon icon-man"></span>
          <p class="paragraph">{{ expert.expert.name }}</p>
        </li>
      {% endfor %}

    </ul>
  </div>

</div>


{% if page.slug == "lvcloud" %}
<script type="text/javascript">
  $(document).ready(() => {
    const tabsContainer = $(".portfolio-tabs__content");
    let activeTab = $(".tabs-tab[data-active='true']")

    setContainerHeight(activeTab.height());

    $('.portfolio-tabs__menu-list').click((e) => {
      if(e.target.tagName == 'LI' && e.target.dataset.active == 'false') {
        const activeMenu = $(".tabs-item[data-active='true']")
              activeIndex = activeMenu[0].dataset.index
              newMenu = $(e.target)
              newTab = $(`#${e.target.dataset.tab}`)
              newIndex = e.target.dataset.index

        activeTab = $(".tabs-tab[data-active='true']");
        setContainerHeight(newTab.height());

        if (newIndex > activeIndex) {
          activeTab.animate({ 'left' : 0 }, 600, function() {
            $(this).css( 'left', '200vw' )
          });
          newTab.css( 'left', '200vw' );
          newTab.animate({ 'left' : '100vw' }, 600);
        }
        else {
          activeTab.animate({ 'left' : '200vw' }, 600);
          newTab.css( 'left', '0' );
          newTab.animate({ 'left' : '100vw' }, 600);
        }

        activeMenu.children('span').animate({ 'opacity' : 0 }, 600);
        newMenu.children('span').animate({ 'opacity' : 1 }, 600);

        activeTab.attr('data-active', 'false');
        activeMenu.attr('data-active', 'false');
        newTab.attr('data-active', 'true');
        newMenu.attr('data-active', 'true');
      }
    });

    function setContainerHeight(tabHeight) {
      let newHeight;

      (window.innerWidth < 811) ? newHeight = (tabHeight + 430) : newHeight = (tabHeight + 280);
      tabsContainer.animate({ 'height' : `${newHeight}px` }, 600);
    }
  })
</script>
{% endif %}
